# 期权分析工具 - 快速开始指南

## 🚀 5分钟快速上手

### 第一步：安装依赖
```bash
pip install -r requirements.txt
```

### 第二步：创建示例数据
```bash
python options_analyzer.py --create-sample
```

### 第三步：编辑数据文件
用Excel或其他编辑器打开 `示例期权数据.csv`，填入你的期权交易数据：

| 股票代码 | 期权类型 | 执行日 | 执行价 | 期权价格 | 每股均价 | 合同数量 |
|----------|----------|--------|--------|----------|----------|----------|
| AAPL | sell call | 2024-03-15 | 180 | 5.00 | 175 | 1 |
| TSLA | sell put | 2024-04-19 | 220 | 6.00 | 240 | 1 |

**重要说明**：
- **期权价格**：输入每股期权费（如5.00表示每股5美元期权费）
- **合同数量**：每份合同对应100股
- **期权类型**：必须是 "sell call" 或 "sell put"

### 第四步：运行分析
```bash
# 基本分析
python options_analyzer.py --input 示例期权数据.csv

# 生成图表
python options_analyzer.py --input 示例期权数据.csv --plot

# 保存为Excel格式
python options_analyzer.py --input 示例期权数据.csv --format excel

# 指定输出文件名
python options_analyzer.py --input 示例期权数据.csv --output 我的分析 --plot
```

## 📊 输出结果说明

### 1. 详细分析结果
每笔期权交易的详细计算：
- **行权利润**：如果被行权的利润（考虑期权费和股价差额）
- **利润百分比**：相对于持仓金额的利润比例
- **盈利平衡价**：股价达到此价格时开始无利润
- **亏损平衡价**：股价跌到此价格时开始亏损

### 2. 股票汇总结果
按股票汇总的统计：
- **总行权利润**：该股票所有期权交易的总利润
- **总利润百分比**：该股票的整体利润比例
- **加权平均成本价**：考虑合同数量的平均成本
- **汇总盈亏平衡价**：该股票的盈亏平衡点

### 3. 可视化图表
- 各股票利润百分比柱状图
- 各股票盈亏平衡价格对比图

## 💡 使用技巧

### 数据格式要求
- **股票代码**：任意文本（如 AAPL, TSLA）
- **期权类型**：必须是 "sell call" 或 "sell put"
- **执行日**：日期格式 YYYY-MM-DD
- **执行价**：数字（如 180.00）
- **期权价格**：每股期权费（如 5.00）
- **每股均价**：持仓成本价（如 175.00）
- **合同数量**：整数（如 1）

### 常见问题
1. **数据格式错误**：确保数值字段只包含数字
2. **期权类型错误**：必须是 "sell call" 或 "sell put"
3. **图表显示问题**：如果中文显示异常，可能需要安装中文字体
4. **输出文件位置**：结果文件保存在 `output/` 目录下

### 高级用法
```bash
# 指定输出文件名
python options_analyzer.py --input 数据.csv --output 我的分析 --plot

# 保存为Excel格式
python options_analyzer.py --input 数据.csv --format excel

# 查看帮助
python options_analyzer.py --help
```

## 📈 计算逻辑

### Sell Call 期权
- **行权利润** = 期权费 + (执行价 - 成本价) × 100股
- **盈利平衡价** = 执行价 + 每股期权费
- **亏损平衡价** = 成本价 - 每股期权费

### Sell Put 期权
- **行权利润** = 期权费 - (成本价 - 执行价) × 100股
- **盈利平衡价** = 执行价 - 每股期权费
- **亏损平衡价** = 成本价 + 每股期权费

## 🎯 示例分析

假设你有以下期权交易：
- AAPL sell call：执行价180，每股期权费5.00，成本价175
- TSLA sell put：执行价220，每股期权费6.00，成本价240

运行分析后，你会看到：
- 每笔交易的详细盈亏分析
- 按股票汇总的总体表现
- 可视化的盈亏平衡图表

这样你就能清楚地了解每笔期权交易的风险和收益情况！

## 📁 输出文件说明

分析完成后，会在 `output/` 目录下生成以下文件：
- `期权分析结果_详细.csv`：每笔交易的详细分析
- `期权分析结果_汇总.csv`：按股票汇总的结果
- `期权分析图表.png`：可视化图表（如果使用 --plot 参数） 